<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1">
<title>Water Tracker - ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ô‡πâ‡∏≥</title>
<style>
:root{
  --bg1:#E8F7FF;
  --bg2:#F8FBFF;
  --accent:#0EA5E9;
  --accent-dark:#0369A1;
  --muted:#6B7280;
  --glass-border:#CDECFB;
  --glass-fill:#7FD3FF;
  --card-bg:rgba(255,255,255,0.9);
  --shadow:0 8px 30px rgba(14,165,233,0.12);
  --radius:16px;
  font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
}
html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#033047;overflow:auto;position:relative;}
canvas#waterCanvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1;}
.container{position:relative;z-index:2;max-width:900px;margin:20px auto;padding:16px;background:var(--card-bg);border-radius:var(--radius);box-shadow:var(--shadow);}
header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}
h1{margin:0;font-size:24px;color:var(--accent-dark)}
p.subtitle{margin:2px 0 0;color:var(--accent)}
main{display:flex;flex-wrap:wrap;gap:20px;margin-top:18px}
.center{flex:1;display:flex;flex-direction:column;align-items:center;min-width:280px}
.stage{width:280px;height:280px;display:flex;align-items:center;justify-content:center;position:relative}
.character{width:200px;height:200px;transition:transform 0.5s ease}
.btn{background:var(--accent);color:#fff;padding:12px 18px;border-radius:999px;border:none;font-weight:700;cursor:pointer;box-shadow:0 6px 16px rgba(3,52,71,0.12)}
.btn:active{transform:translateY(1px)}
.glasses{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:16px}
.glass{height:50px;border-radius:8px 8px 6px 6px;border:2px solid var(--glass-border);display:flex;align-items:flex-end;justify-content:center;padding:4px;background:white}
.glass .water{width:60%;height:0;border-radius:3px;background:var(--glass-fill);transition:height 400ms ease}
.glass.filled .water{height:30px}
aside.card{background:linear-gradient(180deg,#ffffff,#f8fdff);padding:14px;border-radius:12px;border:1px solid #E6F8FF;flex:1;min-width:280px;overflow:auto}
.log-list{max-height:250px;overflow-y:auto;margin-top:10px}
.log-item{display:flex;justify-content:space-between;padding:6px;border-radius:8px;background:#F1FCFF;border:1px solid #E6F9FF;margin-bottom:6px;font-size:14px}
.muted{color:var(--muted);font-size:13px}
.congrats{margin-top:12px;padding:10px;border-radius:10px;background:linear-gradient(90deg,#E6F9FF,#FFFFFF);display:flex;justify-content:space-between;align-items:center;border:1px solid #D1F1FF;flex-wrap:wrap}
.overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:999;flex-direction:column;color:#fff;font-size:24px;font-weight:700;opacity:0;transform:scale(0.7);transition:opacity 0.8s ease, transform 0.8s ease}
.overlay.show{opacity:1;transform:scale(1)}
.modal-bg{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);backdrop-filter:blur(4px);display:none;align-items:center;justify-content:center;z-index:1000;}
.modal{background:white;padding:20px;border-radius:12px;max-width:300px;width:80%;box-shadow:0 8px 20px rgba(0,0,0,0.2);text-align:center;transform:scale(0.8);opacity:0;transition:all 0.3s ease;}
.modal.show{transform:scale(1);opacity:1;}
.modal button{margin:8px;padding:8px 14px;border:none;border-radius:8px;font-weight:700;cursor:pointer;}
.btn-cancel{background:#ccc;color:#333;}
.btn-confirm{background:var(--accent-dark);color:#fff;}
.info-science{margin-top:16px;padding:12px;border-radius:12px;background:rgba(14,165,233,0.08);border:1px solid #AEE0FF;font-size:14px;line-height:1.5;}
@media (max-width:768px){main{flex-direction:column;} .stage{width:240px;height:240px} .character{width:180px;height:180px}}
</style>
</head>
<body>
<canvas id="waterCanvas"></canvas>
<div id="overlay" class="overlay">‡πÄ‡∏™‡∏ô‡∏≠ ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå ‡∏™‡∏£‡∏≤‡∏ß‡∏∏‡∏í‡∏¥ ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏£</div>

<div class="modal-bg" id="modalBg">
  <div class="modal" id="modal">
    <div id="modalText">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
    <div>
      <button class="btn-cancel" id="modalCancel">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      <button class="btn-confirm" id="modalConfirm">‡∏ï‡∏Å‡∏•‡∏á</button>
    </div>
  </div>
</div>

<div class="container">
  <header>
    <div>
      <h1>‡∏ô‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</h1>
      <p class="subtitle">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: <strong id="goalLabel">8</strong> ‡πÅ‡∏Å‡πâ‡∏ß / ‡∏ß‡∏±‡∏ô</p>
    </div>
    <div>
      <button id="resetBtn" class="btn" style="background:#fff;color:var(--accent);border:1px solid var(--glass-border);padding:8px 12px;border-radius:10px;">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
    </div>
  </header>

  <main>
    <section class="center">
      <div class="stage">
        <svg id="character" class="character" viewBox="0 0 240 240" xmlns="http://www.w3.org/2000/svg">
          <circle cx="120" cy="140" r="56" fill="#E0F3FF" stroke="#9ED9FF" stroke-width="3"/>
          <circle cx="120" cy="78" r="42" fill="#fff" stroke="#9ED9FF" stroke-width="3"/>
          <circle cx="108" cy="72" r="4" fill="#153243"/>
          <circle cx="132" cy="72" r="4" fill="#153243"/>
          <path d="M106 86 q14 12 28 0" stroke="#0B6A99" stroke-width="3" fill="none" stroke-linecap="round"/>
          <g transform="translate(40,120)">
            <g transform="translate(64,-8)">
              <rect x="0" y="0" width="24" height="40" rx="4" fill="#F7FEFF" stroke="#9ED9FF" stroke-width="2"></rect>
              <rect id="glassWater" x="0" y="20" width="24" height="0" rx="3" fill="#7FD3FF"></rect>
            </g>
          </g>
        </svg>
      </div>

      <div style="margin-top:12px;display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
        <button id="drinkBtn" class="btn">‡∏î‡∏∑‡πà‡∏° 1 ‡πÅ‡∏Å‡πâ‡∏ß</button>
        <div class="muted">‡∏Ñ‡∏∏‡∏ì‡∏î‡∏∑‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß <strong id="countLabel">0</strong> / <strong id="goalLabel2">8</strong> ‡πÅ‡∏Å‡πâ‡∏ß</div>
      </div>

      <div id="congrats" class="congrats" style="display:none;">
        <div>
          <div style="font-weight:800;color:var(--accent-dark)">‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å üéâ</div>
          <div class="muted">‡∏Ñ‡∏∏‡∏ì‡∏î‡∏∑‡πà‡∏°‡∏Ñ‡∏£‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
        </div>
        <div>
          <button id="nextDayBtn" class="btn" style="background:var(--accent-dark);">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ</button>
        </div>
      </div>

      <div class="info-science">
        <strong>‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö?</strong><br>
        ‡∏ô‡πâ‡∏≥‡∏ä‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢, ‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡∏™‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£, ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥, ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏Å‡∏≤‡∏£‡∏î‡∏∑‡πà‡∏°‡∏Ñ‡∏£‡∏ö 8 ‡πÅ‡∏Å‡πâ‡∏ß‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏≠‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡∏µ ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ï‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÇ‡∏£‡∏Ñ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå
      </div>
    </section>

    <aside class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div style="font-weight:700;color:var(--accent-dark);">‡πÅ‡∏Å‡πâ‡∏ß‡∏ó‡∏µ‡πà‡∏î‡∏∑‡πà‡∏°</div>
          <div class="muted" style="font-size:13px;margin-top:4px;">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏∑‡πà‡∏°</div>
        </div>
      </div>

      <div class="glasses" id="glassesRow" style="margin-top:12px;"></div>
      <hr style="border:none;border-top:1px solid #E6F9FF;margin:12px 0">
      <div style="font-weight:700;color:var(--accent-dark);">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</div>
      <div class="log-list" id="logList"></div>
    </aside>
  </main>

  <footer>
    <div class="muted">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (localStorage)</div>
  </footer>
</div>

<audio id="drinkSound" src="https://www.soundjay.com/button/beep-07.wav" preload="auto"></audio>

<script>
(function(){
const goal=8,key='water-tracker-html-modal';let count=0,logs=[];
const countLabel=document.getElementById('countLabel'),goalLabel2=document.getElementById('goalLabel2'),drinkBtn=document.getElementById('drinkBtn'),resetBtn=document.getElementById('resetBtn'),glassesRow=document.getElementById('glassesRow'),logList=document.getElementById('logList'),congrats=document.getElementById('congrats'),nextDayBtn=document.getElementById('nextDayBtn'),glassWater=document.getElementById('glassWater'),character=document.getElementById('character'),overlay=document.getElementById('overlay'),drinkSound=document.getElementById('drinkSound'),modalBg=document.getElementById('modalBg'),modal=document.getElementById('modal'),modalText=document.getElementById('modalText'),modalCancel=document.getElementById('modalCancel'),modalConfirm=document.getElementById('modalConfirm'),canvas=document.getElementById('waterCanvas'),ctx=canvas.getContext('2d');canvas.width=window.innerWidth;canvas.height=window.innerHeight;

function nowInfo(){const d=new Date(); const pad=(n)=>String(n).padStart(2,'0'); return {iso:d.toISOString(),time:pad(d.getHours())+ ':' + pad(d.getMinutes()),date:d.getFullYear()+'-'+pad(d.getMonth()+1)+'-'+pad(d.getDate())};}
function saveState(){localStorage.setItem(key,JSON.stringify({count,logs}));}
function loadState(){try{const raw=localStorage.getItem(key);if(raw){const p=JSON.parse(raw);count=p.count||0;logs=p.logs||[];}}catch(e){console.warn('load error',e);}}

function renderGlasses(){glassesRow.innerHTML=''; for(let i=0;i<goal;i++){const div=document.createElement('div'); div.className='glass'+(i<count?' filled':''); const water=document.createElement('div'); water.className='water'; if(i<count) water.style.height='30px'; div.appendChild(water); glassesRow.appendChild(div);}
const h=Math.round((count/goal)*20); if(glassWater){glassWater.setAttribute('height',String(h)); glassWater.setAttribute('y',String(20-Math.min(20,h)));}
character.style.transform=`scale(${1+count*0.05})`; }

function renderLogs(){logList.innerHTML=''; if(logs.length===0){const p=document.createElement('div'); p.className='muted'; p.textContent='‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏î‡∏∑‡πà‡∏°‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‚Äî ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏î‡∏∑‡πà‡∏° 1 ‡πÅ‡∏Å‡πâ‡∏ß" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°'; logList.appendChild(p); return;} logs.forEach(l=>{const it=document.createElement('div'); it.className='log-item'; const left=document.createElement('div'); left.innerHTML='<div style="font-weight:700;color:var(--accent-dark)">'+l.time+'</div><div class="muted" style="font-size:12px">'+l.date+'</div>'; it.appendChild(left); logList.appendChild(it);});}

function rerender(){countLabel.textContent=count; renderGlasses(); renderLogs(); saveState(); congrats.style.display=count>=goal?'flex':'none';}

// Particle Water
let drops=[];function spawnDrop(x,y){drops.push({x,y,vy:0});}
function animate(){ctx.clearRect(0,0,canvas.width,canvas.height);drops.forEach(d=>{d.vy+=0.3;d.y+=d.vy;ctx.fillStyle='rgba(127,211,255,0.7)';ctx.beginPath();ctx.arc(d.x,d.y,5,0,Math.PI*2);ctx.fill();});drops=drops.filter(d=>d.y<canvas.height);requestAnimationFrame(animate);}
animate();

drinkBtn.addEventListener('click',()=>{
  if(count>=goal) return; 
  const info=nowInfo(); logs.unshift(info); count=Math.min(goal,logs.length);
  if(drinkSound) drinkSound.play();
  for(let i=0;i<20;i++){spawnDrop(Math.random()*canvas.width,0);}
  rerender();
});

function openModal(text,callback){modalText.textContent=text; modalBg.style.display='flex'; setTimeout(()=>{modal.classList.add('show');},50); function close(){modal.classList.remove('show'); setTimeout(()=>{modalBg.style.display='none';},300);} modalCancel.onclick=()=>{close();}; modalConfirm.onclick=()=>{close();callback();}}

resetBtn.addEventListener('click',()=>{openModal('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',()=>{count=0;logs=[];saveState();rerender();});});
nextDayBtn.addEventListener('click',()=>{openModal('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ?',()=>{count=0;logs=[];saveState();rerender();});});

loadState(); rerender();

overlay.style.display='flex'; setTimeout(()=>{overlay.classList.add('show');},200);
setTimeout(()=>{overlay.classList.remove('show'); setTimeout(()=>{overlay.style.display='none';},500);},5200);

window.addEventListener('resize',()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;});
})();
</script>
</body>
</html>
